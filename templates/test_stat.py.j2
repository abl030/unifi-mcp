"""Integration tests for stat endpoints (auto-generated).

DO NOT EDIT THIS FILE. All changes must be made in the generator.
"""

from __future__ import annotations

import httpx
import pytest

{% for tool in stat_tools %}
{% if tool.resource == "report" %}

class TestStatReport:
    """Tests for stat/report endpoint."""

    def test_list_report(self, authenticated_client):
        """Verify report endpoint returns valid data."""
        try:
            data = authenticated_client.api_post("stat/report/hourly.site", {})
        except (httpx.HTTPStatusError, RuntimeError) as e:
            pytest.skip(f"Report endpoint not available: {e}")
        assert isinstance(data, list)

{% else %}

class TestStat{{ tool.display_name | title | replace('_', '') }}:
    """Tests for stat/{{ tool.resource }} endpoint."""

    def test_list_{{ tool.display_name }}(self, authenticated_client):
        """Verify {{ tool.display_name }} endpoint returns valid data."""
        try:
{% if tool.method == "POST" %}
            data = authenticated_client.api_post("{{ tool.path }}", {})
{% else %}
            data = authenticated_client.api_get("{{ tool.path }}")
{% endif %}
        except (httpx.HTTPStatusError, RuntimeError) as e:
            pytest.skip(f"Endpoint not available in test env: {e}")
        assert isinstance(data, list)
{% if tool.sample_fields %}

    def test_{{ tool.display_name }}_fields(self, authenticated_client):
        """Verify expected fields are present in {{ tool.display_name }} data."""
        try:
{% if tool.method == "POST" %}
            data = authenticated_client.api_post("{{ tool.path }}", {})
{% else %}
            data = authenticated_client.api_get("{{ tool.path }}")
{% endif %}
        except (httpx.HTTPStatusError, RuntimeError) as e:
            pytest.skip(f"Endpoint not available in test env: {e}")
        if not data:
            pytest.skip("No {{ tool.display_name }} data available")
        first = data[0]
        expected_fields = {{ tool.sample_fields }}
        for field in expected_fields:
            assert field in first, f"Missing field '{field}' in {{ tool.display_name }} record"
{% endif %}

{% endif %}
{% endfor %}
